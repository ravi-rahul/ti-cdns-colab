# SPDX-License-Identifier: GPL-2.0
%YAML 1.2
---
$id: http://devicetree.org/schemas/dma/dma-domain.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: DMA Domain Controller Definition

maintainers:
  - Vinod Koul <vkoul@kernel.org>

allOf:
  - $ref: "dma-controller.yaml#"

description:
  On systems where multiple DMA controllers available, none Slave (for example
  memcpy operation) users can not be described in DT as there is no device
  involved from the DMA controller's point of view, DMA binding is not usable.
  However in these systems still a peripheral might need to be serviced by or
  it is better to serviced by specific DMA controller.
  When a memcpy is used to/from a memory mapped region for example a DMA in the
  same domain can perform better.
  For generic software modules doing mem 2 mem operations it also matter that
  they will get a channel from a controller which is faster in DDR to DDR mode
  rather then from the first controller happen to be loaded.

  This property is inherited, so it may be specified in a device node or in any
  of its parent nodes.

properties:
  $dma-domain-controller:
    $ref: /schemas/types.yaml#definitions/phandle
    description:
      phande to the DMA controller node which should be used for the device or
      domain.

examples:
  - |
    / {
        model = "Texas Instruments K3 AM654 SoC";
        compatible = "ti,am654";
        interrupt-parent = <&gic500>;
        /* For modules without device, DDR to DDR is faster on main UDMAP */
        dma-domain-controller = <&main_udmap>;
        #address-cells = <2>;
        #size-cells = <2>;
        ...
    };

    &cbass_main {
        /* For modules within MAIN domain, use main UDMAP */
        dma-domain-controller = <&main_udmap>;

        cbass_main_navss: interconnect0 {
            ...
            main_udmap: dma-controller@31150000 {
                compatible = "ti,am654-navss-main-udmap";
                ...
            };
        };
    };

    &cbass_mcu {
        /* For modules within MCU domain, use mcu UDMAP */
        dma-domain-controller = <&mcu_udmap>;

        cbass_mcu_navss: interconnect1 {
            ...
            mcu_udmap: dma-controller@285c0000 {
                compatible = "ti,am654-navss-mcu-udmap";
                ...
            };
        };

        fss: fss@47000000 {
            compatible = "simple-bus";
            #address-cells = <2>;
            #size-cells = <2>;
            ranges;

            ospi0: spi@47040000 {
                compatible = "ti,am654-ospi", "cdns,qspi-nor";
                ...
                /* memcpy channel will be request from mcu_udmap */
            };
        };
    };
...
